# Менеджер памяти с ECC

[English](/README-en.md)

## Обзор

Этот проект реализует менеджер памяти на языке C, который включает в себя коды коррекции ошибок (ECC) для обеспечения целостности данных. Менеджер памяти использует коды Хэмминга для обнаружения и исправления ошибок, предоставляя надежный способ управления выделением и освобождением памяти, а также операциями с данными.

## Цели

- Разработать систему управления памятью, способную обнаруживать и исправлять ошибки в данных, связанные с одиночными битовыми ошибками.
- Реализовать выделение и освобождение памяти с использованием битовой карты.
- Предоставить функции для записи данных с генерацией ECC и чтения данных с проверкой ECC и исправлением ошибок.
- Симулировать ошибки для тестирования эффективности реализации ECC.

## Особенности

- **Выделение и освобождение памяти**: Использует битовую карту для отслеживания выделенных блоков памяти.
- **Генерация и проверка ECC**: Генерирует ECC для блоков данных и проверяет их во время операций чтения.
- **Исправление ошибок**: Исправляет одиночные битовые ошибки в блоках данных с использованием кодов Хэмминга.
- **Симуляция ошибок**: Вводит случайные битовые ошибки для тестирования функциональности ECC.

## Предпосылки

- Компилятор C (например, gcc 13.2.0)

## Установка

1. Скомпилируйте код:
   ```bash
   gcc -o ecc_memory_manager main.c
   ```
2. Запустите программу:
   ```bash
   ./ecc_memory_manager
   ```

## Использование

Программа демонстрирует выделение, запись, симуляцию ошибок, чтение и освобождение блоков памяти с защитой ECC. По умолчанию она выполняет следующие шаги:

- Выделяет блок памяти.
- Записывает данные в блок с генерацией ECC.
- Симулирует ошибку, меняя бит в данных.
- Читает данные с проверкой ECC и исправлением ошибок.
- Проверяет, была ли ошибка успешно исправлена.
- Освобождает блок памяти.

## Архитектура

### Структуры данных

- **MemoryManager**: Структура, содержащая массив данных, массив ECC и битовую карту выделения.
  ```c
  typedef struct {
      uint8_t data[DATA_SIZE];
      uint8_t ecc[ECC_SIZE];
      uint8_t bitmap[DATA_SIZE / 4];
  } MemoryManager;
  ```

### Функции

- **Вычисление паритета**: Вычисляет бит паритета для заданного значения.
  ```c
  static inline uint8_t parity(uint8_t x);
  ```

- **Генерация ECC**: Вычисляет ECC для 4-битного сегмента данных.
  ```c
  void ecc_calculate(uint8_t *data, uint8_t *ecc);
  ```

- **Проверка и исправление ECC**: Проверяет ECC и исправляет одиночные битовые ошибки.
  ```c
  void ecc_check_and_correct(uint8_t *data, uint8_t *ecc);
  ```

- **Выделение памяти**: Находит и помечает свободный блок памяти в битовой карте.
  ```c
  int ecc_allocate(MemoryManager *mm);
  ```

- **Освобождение памяти**: Помечает блок памяти как свободный в битовой карте.
  ```c
  void ecc_deallocate(MemoryManager *mm, int index);
  ```

- **Операция записи**: Записывает данные в память и генерирует ECC.
  ```c
  void ecc_write(MemoryManager *mm, int index, uint8_t *data, int size);
  ```

- **Операция чтения**: Читает данные из памяти, проверяет ECC и исправляет ошибки.
  ```c
  void ecc_read(MemoryManager *mm, int index, uint8_t *data, int size);
  ```

## Тестирование

Программа включает простой тестовый случай, который:

- Выделяет блок памяти.
- Записывает пример данных в блок.
- Вводит ошибку, переворачивая бит в данных.
- Читает данные и исправляет ошибку с использованием ECC.
- Проверяет, совпадают ли данные с исходными примерными данными.

## Результаты

Программа выводит, была ли ошибка успешно исправлена:
```
Error fixed!
```
или
```
Fatal error.
```

## Ссылки

- Moon, T. K. (2005). *Error Correction Coding: Mathematical Methods and Algorithms*. John Wiley & Sons.
- Silberschatz, A., Gagne, G., & Galvin, P. B. (2013). *Operating System Concepts*. Wiley.
